ekf_filter_node:
  ros__parameters:
    frequency: 100.0      # EKF 연산 주기
    two_d_mode: true
    publish_tf: true
    
    map_frame: map
    odom_frame: odom
    base_link_frame: base_link
    world_frame: odom

    # [수정] 우리가 만든 필터링된 IMU 사용
    imu0: /imu/data
    imu0_remove_gravitational_acceleration: false # 우리 코드에서 이미 제거함
    
    # 설정 순서: [x, y, z, roll, pitch, yaw, vx, vy, vz, vroll, vpitch, vyaw, ax, ay, az]
    imu0_config: [false, false, false,
                  true,  true,  true,  # Orientation (Roll, Pitch, Yaw)
                  false, false, false,
                  true,  true,  true,  # Angular Velocity (회전 속도)
                  true,  true,  false] # Linear Acceleration (X, Y 가속도)

    imu0_relative: false   # 절대 각도(북쪽 기준) 사용
    imu0_queue_size: 10

    # GPS 기반 Odometry (navsat_transform 결과물)
    odom0: /odometry/gps
    odom0_config: [true,  true,  false, # X, Y 위치만 신뢰
                   false, false, false,
                   false, false, false,
                   false, false, false,
                   false, false, false]
    odom0_queue_size: 10

navsat_transform: # ekf_filter_node와 동일한 라인에서 시작해야 함
  ros__parameters:
    frequency: 100.0  # 말씀하신 대로 100으로 통일
    delay: 3.0
    magnetic_declination_radians: 0.15
    yaw_offset: 2.86
    zero_altitude: true
    wait_for_datum: false # 첫 GPS 수신지를 (0,0)으로 설정
    use_odometry_yaw: false
    broadcast_cartesian_transform: true
    publish_filtered_gps: true          